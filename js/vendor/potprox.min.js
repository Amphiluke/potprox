/*!
potprox v0.7.1
https://amphiluke.github.io/potprox/
*/
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((t=t||self).potprox={})}(this,(function(t){"use strict";class r{rSqr(t){let r=0,e=0;for(let{r:i,e:s}of t){r+=s;let t=s-this.at(i);e+=t*t}r/=t.length;let i=0;for(let{e:e}of t){let t=e-r;i+=t*t}return 1-e/i}*points({start:t=this.r0/2,end:r=2*this.r0,step:e=(r-t)/49}={}){let i=0,s=t,o=Math.sign(r-t);for(e=Math.abs(e)*o;(r-s)*o>=0;)yield{r:s,e:this.at(s),index:i},s=t+e*++i;return{r:r,e:this.at(r)}}}const e="Too little points. Approximation is impossible",i="Approximated data must be an array of points",s=t=>`The “${t}” parameter must be a finite number`,o=(t,r=0)=>`The “${t}” parameter must be greater than ${r}`,n="Distance must be a number",a="Distance mustn’t be less than 0";let h=new WeakMap;class w extends r{constructor({epsilon:t=1,sigma:r=1}={}){super(),h.set(this,{}),this.epsilon=t,this.sigma=r}static get type(){return"LennardJones"}static from(t){if(!Array.isArray(t))throw new TypeError(i);if(t.length<3)throw new Error(e);let r=0,s=0,o=0,n=0,a=0;for(let{r:e,e:i}of t)r+=Math.pow(e,-24),s+=Math.pow(e,-18),o+=i*Math.pow(e,-12),n+=Math.pow(e,-12),a+=i*Math.pow(e,-6);let h=(a-s*o/r)/(n-s*s/r),f=(o-s*h)/r,p=Math.pow(-f/h,1/6),l=f/(4*Math.pow(p,12));return new w({epsilon:l,sigma:p})}get epsilon(){return h.get(this).epsilon}set epsilon(t){if(!Number.isFinite(t))throw new TypeError(s("epsilon"));if(t<=0)throw new RangeError(o("epsilon"));h.get(this).epsilon=t}get sigma(){return h.get(this).sigma}set sigma(t){if(!Number.isFinite(t))throw new TypeError(s("sigma"));if(t<=0)throw new RangeError(o("sigma"));h.get(this).sigma=t}get r0(){return 1.122462048309373*this.sigma}set r0(t){this.sigma=t/1.122462048309373}at(t){if("number"!=typeof t)throw new TypeError(n);if(t<0)throw new RangeError(a);let{epsilon:r,sigma:e}=this;return 4*r*(Math.pow(e/t,12)-Math.pow(e/t,6))}toJSON(){return{type:w.type,epsilon:this.epsilon,sigma:this.sigma}}}let f=new WeakMap;class p extends r{constructor({d0:t=1,r0:r=1,a:e=2}={}){super(),f.set(this,{}),this.d0=t,this.r0=r,this.a=e}static get type(){return"Buckingham"}static fastFrom(t){if(!Array.isArray(t))throw new TypeError(i);if(t.length<3)throw new Error(e);t=t.slice().sort((t,r)=>t.r-r.r);let r,s,o,n=Number.POSITIVE_INFINITY,a=1;for(let{r:r,e:e}of t)e<n&&(n=e,a=r);n=Math.abs(n);for(let e=1;e<t.length&&(r=t[e-1],s=t[e],!(s.r>=a||r.e<0||s.e<0));e++);if(r&&s&&r.r<a&&s.r<=a){let t=r.e*(r.r-s.r)/(s.e-r.e)+r.r;if(t>0){let r=1-t/a,e=Math.pow(a/t,6)/6;o=(e-r-Math.sqrt(e*e-2*r*e-r*r))/(r*r),Number.isFinite(o)||(o=void 0)}}return new p({d0:n,r0:a,a:o})}static from(t,{d0Conv:r=.001,r0Conv:e=.001,aConv:i=.001}={}){let s=this.fastFrom(t),{d0:o,r0:n,a:a}=s;const h=o*r,w=n*e,f=a*i;let p,l,g;do{let r=0,e=0,i=0,s=0,h=0,w=0,f=0,u=0,d=0;for(let{r:p,e:l}of t){let t=a*Math.pow(n/p,6),g=Math.exp(a*(1-p/n)),b=o/(a-6)*(6*g-t),m=b/o,y=o/(a-6)*(6*g*a*p/(n*n)-6*t/n),M=-o/((a-6)*(a-6))*(6*g-t)+o/(a-6)*(6*(1-p/n)*g-t/a);r+=m*m,e+=y*m,i+=M*m,s+=(b-l)*m,h+=y*y,w+=M*y,f+=(b-l)*y,u+=M*M,d+=(b-l)*M}g=-(s-r*f/e-(e-r*h/e)/(e-r*w/i)*(s-r*d/i))/(i-r*w/e-(i-r*u/i)*(e-r*h/e)/(e-r*w/i)),l=((i-r*w/e)*g+(s-r*f/e))/(r*h/e-e),p=(-e*l-i*g-s)/r,o+=p,n+=l,a+=g}while(Math.abs(p)>h&&Math.abs(l)>w&&Math.abs(g)>f);return s.d0=o,s.r0=n,s.a=a,s}get d0(){return f.get(this).d0}set d0(t){if(!Number.isFinite(t))throw new TypeError(s("d0"));if(t<=0)throw new RangeError(o("d0"));f.get(this).d0=t}get r0(){return f.get(this).r0}set r0(t){if(!Number.isFinite(t))throw new TypeError(s("r0"));if(t<=0)throw new RangeError(o("r0"));f.get(this).r0=t}get a(){return f.get(this).a}set a(t){if(!Number.isFinite(t))throw new TypeError(s("a"));if(t<=0)throw new RangeError(o("a"));f.get(this).a=t}at(t){if("number"!=typeof t)throw new TypeError(n);if(t<0)throw new RangeError(a);let{d0:r,r0:e,a:i}=this;return r/(i-6)*(6*Math.exp(i*(1-t/e))-i*Math.pow(e/t,6))}toJSON(){return{type:p.type,d0:this.d0,r0:this.r0,a:this.a}}}let l=new WeakMap;class g extends r{constructor({d0:t=1,r0:r=1,a:e=1}={}){super(),l.set(this,{}),this.d0=t,this.r0=r,this.a=e}static get type(){return"Morse"}static fastFrom(t){if(!Array.isArray(t))throw new TypeError(i);if(t.length<3)throw new Error(e);let r=Number.POSITIVE_INFINITY,s=1;for(let{r:e,e:i}of t)i<r&&(r=i,s=e);r=Math.abs(r);let o=0,n=0;for(let{r:e,e:i}of t){let t=Math.sqrt(1+i/r),a=Number.NaN;e>s?a=Math.log(1-t)/(s-e):e<s&&(a=Math.log(1+t)/(s-e)),Number.isFinite(a)&&(o+=a,n++)}return o/=n,new g({d0:r,r0:s,a:o})}static from(t,{d0Conv:r=.001,r0Conv:e=.001,aConv:i=.001}={}){let s=this.fastFrom(t),{d0:o,r0:n,a:a}=s;const h=o*r,w=n*e,f=a*i;let p,l,g;do{let r=0,e=0,i=0,s=0,h=0,w=0,f=0,u=0,d=0;for(let{r:p,e:l}of t){let t=Math.exp(a*(n-p)),g=o*(1-t)*(1-t)-o,b=g/o,m=-2*o*(1-t)*a*t,y=2*o*(1-t)*(p-n)*t;r+=b*b,e+=m*b,i+=y*b,s+=(g-l)*b,h+=m*m,w+=y*m,f+=(g-l)*m,u+=y*y,d+=(g-l)*y}g=-(s-r*f/e-(e-r*h/e)/(e-r*w/i)*(s-r*d/i))/(i-r*w/e-(i-r*u/i)*(e-r*h/e)/(e-r*w/i)),l=((i-r*w/e)*g+(s-r*f/e))/(r*h/e-e),p=(-e*l-i*g-s)/r,o+=p,n+=l,a+=g}while(Math.abs(p)>h&&Math.abs(l)>w&&Math.abs(g)>f);return s.d0=o,s.r0=n,s.a=a,s}get d0(){return l.get(this).d0}set d0(t){if(!Number.isFinite(t))throw new TypeError(s("d0"));if(t<=0)throw new RangeError(o("d0"));l.get(this).d0=t}get r0(){return l.get(this).r0}set r0(t){if(!Number.isFinite(t))throw new TypeError(s("r0"));if(t<=0)throw new RangeError(o("r0"));l.get(this).r0=t}get a(){return l.get(this).a}set a(t){if(!Number.isFinite(t))throw new TypeError(s("a"));if(t<=0)throw new RangeError(o("a"));l.get(this).a=t}at(t){if("number"!=typeof t)throw new TypeError(n);if(t<0)throw new RangeError(a);let{d0:r,r0:e,a:i}=this,s=1-Math.exp(i*(e-t));return r*s*s-r}toJSON(){return{type:g.type,d0:this.d0,r0:this.r0,a:this.a}}}let u=new WeakMap;class d extends r{constructor({d0:t=1,r0:r=1,b:e=2}={}){super(),u.set(this,{}),this.d0=t,this.r0=r,this.b=e}static get type(){return"Rydberg"}static fastFrom(t){if(!Array.isArray(t))throw new TypeError(i);if(t.length<3)throw new Error(e);t=t.slice().sort((t,r)=>t.r-r.r);let r,s,o,n=Number.POSITIVE_INFINITY,a=1;for(let{r:r,e:e}of t)e<n&&(n=e,a=r);n=Math.abs(n);for(let e=1;e<t.length&&(r=t[e-1],s=t[e],!(s.r>=a||r.e<0||s.e<0));e++);if(r&&s&&r.r<a&&s.r<=a){let t=r.e*(r.r-s.r)/(s.e-r.e)+r.r;t>0&&(o=a/(a-t))}return new d({d0:n,r0:a,b:o})}static from(t,{d0Conv:r=.001,r0Conv:e=.001,bConv:i=.001}={}){let s=this.fastFrom(t),{d0:o,r0:n,b:a}=s;const h=o*r,w=n*e,f=a*i;let p,l,g;do{let r=0,e=0,i=0,s=0,h=0,w=0,f=0,u=0,d=0;for(let{r:p,e:l}of t){let t=a*(p/n-1),g=Math.exp(-t),b=-o*(1+t)*g,m=b/o,y=-o*a*p/(n*n)*g*t,M=o*t/a*g*t;r+=m*m,e+=y*m,i+=M*m,s+=(b-l)*m,h+=y*y,w+=M*y,f+=(b-l)*y,u+=M*M,d+=(b-l)*M}g=-(s-r*f/e-(e-r*h/e)/(e-r*w/i)*(s-r*d/i))/(i-r*w/e-(i-r*u/i)*(e-r*h/e)/(e-r*w/i)),l=((i-r*w/e)*g+(s-r*f/e))/(r*h/e-e),p=(-e*l-i*g-s)/r,o+=p,n+=l,a+=g}while(Math.abs(p)>h&&Math.abs(l)>w&&Math.abs(g)>f);return s.d0=o,s.r0=n,s.b=a,s}get d0(){return u.get(this).d0}set d0(t){if(!Number.isFinite(t))throw new TypeError(s("d0"));if(t<=0)throw new RangeError(o("d0"));u.get(this).d0=t}get r0(){return u.get(this).r0}set r0(t){if(!Number.isFinite(t))throw new TypeError(s("r0"));if(t<=0)throw new RangeError(o("r0"));u.get(this).r0=t}get b(){return u.get(this).b}set b(t){if(!Number.isFinite(t))throw new TypeError(s("b"));if(t<=1)throw new RangeError(o("b",1));u.get(this).b=t}at(t){if("number"!=typeof t)throw new TypeError(n);if(t<0)throw new RangeError(a);let{d0:r,r0:e,b:i}=this,s=i*(t-e)/e;return-r*(1+s)*Math.exp(-s)}toJSON(){return{type:d.type,d0:this.d0,r0:this.r0,b:this.b}}}let b=new WeakMap;class m extends r{constructor({d0:t=1,r0:r=1,b:e=1}={}){super(),b.set(this,{}),this.d0=t,this.r0=r,this.b=e}static get type(){return"Varshni3"}static fastFrom(t){if(!Array.isArray(t))throw new TypeError(i);if(t.length<3)throw new Error(e);let r=Number.POSITIVE_INFINITY,s=1;for(let{r:e,e:i}of t)i<r&&(r=i,s=e);r=Math.abs(r);let o=0,n=0;for(let{r:e,e:i}of t){let t=Math.sqrt(1+i/r),a=Number.NaN;e>s?a=Math.log(e/s*(1-t))/(s*s-e*e):e<s&&(a=Math.log(e/s*(1+t))/(s*s-e*e)),Number.isFinite(a)&&(o+=a,n++)}return o/=n,new m({d0:r,r0:s,b:o})}static from(t,{d0Conv:r=.001,r0Conv:e=.001,bConv:i=.001}={}){let s=this.fastFrom(t),{d0:o,r0:n,b:a}=s;const h=o*r,w=n*e,f=a*i;let p,l,g;do{let r=0,e=0,i=0,s=0,h=0,w=0,f=0,u=0,d=0;for(let{r:p,e:l}of t){let t=n/p*Math.exp(a*(n*n-p*p)),g=o*(1-t)*(1-t)-o,b=g/o,m=2*o*(1-t)*(-t/n-2*t*a*n),y=2*o*(1-t)*t*(p*p-n*n);r+=b*b,e+=m*b,i+=y*b,s+=(g-l)*b,h+=m*m,w+=y*m,f+=(g-l)*m,u+=y*y,d+=(g-l)*y}g=-(s-r*f/e-(e-r*h/e)/(e-r*w/i)*(s-r*d/i))/(i-r*w/e-(i-r*u/i)*(e-r*h/e)/(e-r*w/i)),l=((i-r*w/e)*g+(s-r*f/e))/(r*h/e-e),p=(-e*l-i*g-s)/r,o+=p,n+=l,a+=g}while(Math.abs(p)>h&&Math.abs(l)>w&&Math.abs(g)>f);return s.d0=o,s.r0=n,s.b=a,s}get d0(){return b.get(this).d0}set d0(t){if(!Number.isFinite(t))throw new TypeError(s("d0"));if(t<=0)throw new RangeError(o("d0"));b.get(this).d0=t}get r0(){return b.get(this).r0}set r0(t){if(!Number.isFinite(t))throw new TypeError(s("r0"));if(t<=0)throw new RangeError(o("r0"));b.get(this).r0=t}get b(){return b.get(this).b}set b(t){if(!Number.isFinite(t))throw new TypeError(s("b"));if(t<=0)throw new RangeError(o("b"));b.get(this).b=t}at(t){if("number"!=typeof t)throw new TypeError(n);if(t<0)throw new RangeError(a);let{d0:r,r0:e,b:i}=this,s=1-e/t*Math.exp(i*(e*e-t*t));return r*s*s-r}toJSON(){return{type:m.type,d0:this.d0,r0:this.r0,b:this.b}}}t.Buckingham=p,t.LennardJones=w,t.Morse=g,t.Rydberg=d,t.Varshni3=m,Object.defineProperty(t,"__esModule",{value:!0})}));
